---
alwaysApply: true
priority: HIGH
---

# Workflow

## Step 0 — Generate Plan
- Generate a migration plan for `{ProgramName}` and save as Markdown under `/plan/`.
- Use `plan_generation.mdc` settings for file location and format.

---

## Step 1 — Pre-Migration
- Read `.cursor/docs/net6/` for ALL target libraries.
- Review `.cursor/docs/net4/` for original patterns (reference only).
- Check `critical-patterns-learned.md` for .NET 6 structure.
- Identify all SP and SQL queries (MUST NOT change).

---

## Step 2 — Common Layer
**Agent:** `ToCSharpCommon`

**Deliverables:**
- `{ProgramName}Common` project
- All DTOs, enums, interfaces
- Validated `.csproj` settings

---

## Step 3 — Back Layer
**Agent:** `ToCSharpBack`

**Deliverables:**
- `{ProgramName}BackResources` project
- `{ProgramName}Back` project
- Logger and Activity classes (Template #1, #2)
- Business logic classes (Template #4, #14, #15)
- Validated `.csproj` settings

---

## Step 4 — Service Layer
**Agent:** `ToCSharpService`

**Deliverables:**
- `{ProgramName}Service` project
- Controller implementing interface (Template #5, #15, #16)
- `R_BackGlobalVar` usage for `IClientHelper`
- Streaming context for custom parameters
- Validated `.csproj` settings

---

## Step 5 — Model Layer
**Agent:** `ToCSharpViewModel`

**Deliverables:**
- `{ProgramName}FrontResources` project
- `{ProgramName}Model` project (Template #6)
- ViewModels in `VMs/` folder (Template #12, #17)
- Validated `.csproj` settings

---

## Step 6 — Frontend Layer
**Agent:** `ToCSharpFront`

**Deliverables:**
- `{ProgramName}Front` project
- `.razor` and `.razor.cs` files (Template #7–13, #18–20)
- Validated `.csproj` settings

---

## Step 7 — Validation
**Agent:** `ValidationAndBuild`

**Deliverables:**
- Complete `checklist-migration.md` validation
- Build success for all projects
- Warning classification report (Template #13)
- Final quality report

---

## Step 8 — Final Checks
- Behavioral parity confirmed with .NET 4 code
- No SQL queries modified
- No SP names changed
- All error messages from resources
- All compilation warnings addressed
