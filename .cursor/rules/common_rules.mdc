---
alwaysApply: false
priority: HIGH
glob: "*ToCSharpCommon*"
---

# COMMON LAYER RULES

## Project Structure
- Location: `COMMON/{module}/{ProgramName}Common/`
- Target: `netstandard2.1`
- Purpose: DTOs, enums, interfaces only

## Interface Requirements
- Must inherit: `R_IServiceCRUDAsyncBase<{ProgramName}DTO>`

## DTO Design Rules
- All methods that return `List` use streaming patterns (NON-NEGOTIABLE) 
- Each method in `{ProgramName}*Cls.vb` will have its ParameterDTO and ResultDTO, except `R_*` methods 
- Add `//NOTE: Global Variable` for properties that get value from R_BackGlobalVar.
- Property naming matches VB.NET exactly (`CTRANS_DEPT_CODE`)
- Use `string.Empty` for string defaults
- All properties that VB.NET accesses must exist
- Variables with "I" prefix use `int` not `short` (critical naming convention)
- Consolidate all enums here
- No Logger/Activity in Common
- **IGNORE Print and Batch Functions**: Do NOT include print/report methods (GetPrintData, GetBatchData) in Common interfaces - these are Back-only operations

## Rules
- MUST preserve exact function signatures and type safety
- MUST follow variable naming (PascalCase properties, _snakeCase fields)
- MUST use nullable references correctly
- MUST convert Module → static class

## Violations
- ❌ Business logic in Common
- ❌ Logger/Activity in Common
- ❌ Generic DTOs for all parameters
- ❌ Missing properties that VB.NET accesses
- ❌ Using `short` for variables with "I" prefix
- ❌ Using `R_IServiceCRUDBase` for interface (use `R_IServiceCRUDAsyncBase`)