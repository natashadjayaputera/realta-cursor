---
alwaysApply: false
priority: HIGH
glob: "*ToCSharpBack*"
---

# BACK LAYER RULES

## Project Structure
- Location: `BACK/{module}/{ProgramName}Back/` and `BACK/{module}/{ProgramName}BackResources/`
- Target: `net6.0`
- Purpose: Business logic, logging, resources

## Migration Validation
- **Start with function count verification** - ensure VB.NET and C# have same method counts
- **Interface must exactly match business logic class methods** - no extra methods
- **All method signatures must align** between VB.NET original and C# implementation

## Resource Files
- Location: Root folder of BackResources project
- Files: `{ProgramName}BackResources_msgrsc.resx` (English), `{ProgramName}BackResources_msgrsc.id.resx` (Indonesian)
- Pattern: `R_Utility.R_GetError(typeof(Resources_Dummy_Class), pcErrorId)`

## Class Separation Pattern
- **Main Business Logic**: `{ProgramName}Cls.cs` - Inherits R_BusinessObjectAsync (CRUD + Grid methods only)
- **Print Operations**: `{ProgramName}PrintCls.cs` - Standalone class for print methods (NO inheritance)
- **Batch Operations**: `{ProgramName}BatchCls.cs` - Standalone class for batch methods (NO inheritance)

## Rules
- MUST: Use `GetError()` for all errors
- MUST: Never modify SQL or SP names
- MUST: Log method start/end and queries
- MUST: Separate print/batch methods into dedicated classes

## Violations
- ❌ Logger/Activity in Common project
- ❌ Custom Logger/Activity implementations
- ❌ Missing query logging before SqlExecQueryAsync
- ❌ Missing START/END method logging
- ❌ Hardcoded error messages
- ❌ Manual connection disposal (not using 'using')
- ❌ Batch processing implementation (must be commented out unless explicitly requested)
- ❌ Different method counts between VB.NET and C# implementations
- ❌ Interface methods not matching business logic class methods
- ❌ Skip `loDb = null` in finally
- ❌ Execute queries without logging
- ❌ Print/batch methods in main business logic class