---
alwaysApply: false
priority: HIGH
glob: "*ToCSharpFront*"
---

# FRONTEND LAYER RULES

## Project Structure
- Location: `FRONT/{ProgramName}Front/`
- Target: `net6.0`
- SDK: `Microsoft.NET.Sdk.Razor`

## .csproj Template
```xml
<Project Sdk="Microsoft.NET.Sdk.Razor">
	<PropertyGroup>
		<TargetFramework>net6.0</TargetFramework>
		<LangVersion>10.0</LangVersion>
		<Nullable>enable</Nullable>
		<ImplicitUsings>disable</ImplicitUsings>
	</PropertyGroup>

	<ItemGroup>
		<SupportedPlatform Include="browser" />
	</ItemGroup>

	<ItemGroup>
		<PackageReference Include="Microsoft.AspNetCore.Components.Web" Version="6.0.36" />
	</ItemGroup>

	<ItemGroup>
		<Reference Include="R_APICommonDTO">
			<HintPath>..\..\..\..\SYSTEM\SOURCE\LIBRARY\Front\R_APICommonDTO.dll</HintPath>
		</Reference>
		<Reference Include="R_CommonFrontBackAPI">
			<HintPath>..\..\..\..\SYSTEM\SOURCE\LIBRARY\Front\R_CommonFrontBackAPI.dll</HintPath>
		</Reference>
		<Reference Include="R_BlazorFrontEnd">
			<HintPath>..\..\..\..\SYSTEM\SOURCE\LIBRARY\Front\R_BlazorFrontEnd.dll</HintPath>
		</Reference>
		<Reference Include="R_BlazorFrontEnd.Controls">
			<HintPath>..\..\..\..\SYSTEM\SOURCE\LIBRARY\Front\R_BlazorFrontEnd.Controls.dll</HintPath>
		</Reference>
		<Reference Include="BlazorClientHelper">
			<HintPath>..\..\..\..\SYSTEM\SOURCE\LIBRARY\Menu\BlazorClientHelper.dll</HintPath>
		</Reference>
	</ItemGroup>

	<ItemGroup>
		<ProjectReference Include="..\{ProgramName}Model\{ProgramName}Model.csproj" />
		<ProjectReference Include="..\{ProgramName}FrontResources\{ProgramName}FrontResources.csproj" />
	</ItemGroup>
</Project>
```

## Front Rules
- `R_Init_From_Master` → Initialize UI Components data, Capture parameters, Refresh grid
- Error messages from resources
- Explicit `TValue` for numeric grid columns

### Date Handling
- If data return DateString fields (e.g., `C*_DATE`) → nullable `DateTime` (`D*_DATE`) in `*ViewModel.cs`
- Date format: `'yyyyMMdd'` unless otherwise specified in `*ViewModel.cs`
- `R_DatePicker` binds to `D*_DATE` in `*.razor`

## Layout Rules
- Each R_StackLayout Row must have column sum ≤ 12
- Use nested R_StackLayout Row="true" for each row
- Last R_ItemLayout has `auto="false"`

## Using Statements
- All @using statements in _Imports.razor
- NO @using in .razor files

## UI Architecture Rules
- **Data Validation**: All validation logic MUST be in ViewModel, not in Razor code-behind
- **Separation of Concerns**: 
  - **ViewModel**: Business logic, validation, data state management
  - **Code-behind**: UI events, component references, UI-specific logic only
- **Component References**: Store only UI component references in code-behind (`R_Grid? _gridRef`)
- **Data State**: All business data must be in ViewModel properties, never in Razor.cs fields

## SDK and Project Configuration Rules
- **CRITICAL**: Must use `Microsoft.NET.Sdk.Razor` for Blazor component libraries
- **Required Elements**: `<SupportedPlatform Include="browser" />` is mandatory
- **ItemGroup Order**: PropertyGroup → SupportedPlatform → PackageReference → DLL References → ProjectReferences

## Violations
- ❌ R_Conductor for inquiry programs
- ❌ Using `Text` parameter on R_Button
- ❌ R_Lookup without R_ItemLayout wrapper
- ❌ @using statements in .razor files
- ❌ Hardcoded strings instead of Localizer
- ❌ Storing form data in Razor.cs private fields
- ❌ Business logic state in code-behind
- ❌ Data tracking variables in Razor.cs
- ❌ `R_Button` for navigation
- ❌ Explicit `TItem`/`TValue` unless required
- ❌ **CRITICAL**: Data validation logic in Razor code-behind
- ❌ **CRITICAL**: Wrong SDK template (`Microsoft.NET.Sdk` instead of `Microsoft.NET.Sdk.Razor`)
- ❌ **CRITICAL**: Missing `<SupportedPlatform Include="browser" />` element
- ❌ **CRITICAL**: Wrong ItemGroup ordering in .csproj file