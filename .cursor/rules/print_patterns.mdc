---
alwaysApply: false
priority: HIGH
glob: "*ToCSharpPrint*"
---

# PRINT REPORT PATTERNS

## Constructor Pattern
```csharp
private readonly Logger{ProgramName} _logger;
private readonly ActivitySource _activitySource;

public {ProgramName}PrintCls()
{
    _logger = Logger{ProgramName}.R_GetInstanceLogger();
    _activitySource = {ProgramName}Activity.R_GetInstanceActivitySource();
}
```

## Implementation Pattern IN `{ProgramName}PrintCls.cs`
```csharp
// In Back layer only - NOT in Common interface
public List<{ProgramName}GetPrintDataResultDTO> GetPrintData({ProgramName}GetPrintDataParameterDTO poParameter)
{
    string lcMethod = nameof(GetPrintData);
    using var activity = _activitySource.StartActivity(lcMethod);
    _logger.LogInfo("START method {MethodName}", lcMethod);

    var loEx = new R_Exception();
    var loRtn = new List<{ProgramName}GetPrintDataResultDTO>();
    var loDb = new R_Db();
    
    try
    {
        using DbConnection loConn = loDb.GetConnection();
        using DbCommand loCmd = loDb.GetCommand();
        
        // Direct database access with stored procedure
        // Log query and parameters before execution
        // No streaming context needed for print operations
        // Use synchronous database methods (SqlExecQuery, not SqlExecQueryAsync)
    }
    catch (Exception ex)
    {
        loEx.Add(ex);
        _logger.LogError(loEx);
    }
    finally
    {
        if (loDb != null) 
            loDb = null;
    }
    
    loEx.ThrowExceptionIfErrors();
    _logger.LogInfo("END method {MethodName}", lcMethod);
    return loRtn;
}
```